# Тестовое задание: REST API для сервиса управления задачами

Это реализация тестового задания по разработке REST API для простого сервиса управления задачами на стеке Spring Boot.

## Содержание
- [Выполненные пункты](#выполненные-пункты)
- [Стек технологий](#стек-технологий)
- [Как запустить проект](#как-запустить-проект)
    - [Запуск через Docker Compose](#запуск-через-docker-compose)
- [Структура API](#структура-api)
    - [Аутентификация](#аутентификация)
    - [Эндпоинты](#эндпоинты)
- [Документация API (Swagger)](#документация-api-swagger)

---

## Выполненные пункты

В рамках проекта были реализованы все основные и дополнительные задания.

### Основные задания:

*   **[✔️] Разработаны CRUD эндпоинты для управления задачами:**
    *   `POST /api/tasks` — Создание задачи.
    *   `GET /api/tasks` — Получение списка всех задач.
    *   `PUT /api/tasks/{id}` — Обновление задачи.
    *   `DELETE /api/tasks/{id}` — Удаление задачи.
    *   `GET /api/tasks/{id}` — Получение задачи по ID.
*   **[✔️] Подключена реляционная база данных:**
    *   Для локальной разработки используется файловая **H2 Database**.
    *   Для запуска в Docker используется **PostgreSQL**, что является более production-ready решением.
    *   Миграции базы данных управляются с помощью **Liquibase**.
*   **[✔️] Реализовано логирование:**
    *   Основные действия в сервисах логируются с помощью SLF4J.

### Дополнительные задания:

*   **[✔️] (+1) Внешний HTTP-запрос:** Реализован асинхронный (`@Async`) GET-запрос на `https://api.restful-api.dev/objects` при получении списка всех задач. Ответ логируется без блокировки основного потока.
*   **[✔️] (+1) Unit-тесты:** Написаны юнит-тесты для `TaskServiceImpl` с использованием **JUnit 5** и **Mockito**. Тесты покрывают основную бизнес-логику CRUD-операций и взаимодействие с моками зависимостей.
*   **[✔️] (+1) Отправка Email:** Реализована отправка email-уведомления на почту текущего аутентифицированного пользователя после успешного создания новой задачи. Используется `spring-boot-starter-mail`.
*   **[✔️] (+1) Basic Authentication:** Все эндпоинты, кроме регистрации, защищены с помощью **Spring Security Basic Authentication**.
*   **[✔️] (+1) Кэширование с Redis:** Эндпоинт для получения списка всех задач (`GET /api/tasks`) кэшируется с использованием **Redis**. Кэш инвалидируется при создании, обновлении или удалении задач. 
*   **[✔️] (+1) Dockerfile:** Написан многоэтапный `Dockerfile`.
*   **[✔️] (Дополнительно) Docker Compose:** Создан файл `docker-compose.yml`, который позволяет одной командой поднять всё окружение: приложение, базу данных и кэш Redis.

---

## Стек технологий

*   **Java 17**
*   **Spring Boot 3.x**
*   **Spring MVC** — для создания REST-контроллеров
*   **Spring Data JPA** — для работы с базой данных
*   **Spring Security** — для Basic Authentication
*   **Spring Cache** — для абстракции кэширования
*   **H2 Database** — реляционные базы данных
*   **Liquibase** — для управления миграциями схемы БД
*   **Redis** — для кэширования
*   **Lombok** — для сокращения boilerplate-кода
*   **MapStruct** — для маппинга между DTO и сущностями
*   **JUnit 5 & Mockito** — для юнит-тестирования
*   **Maven** — для сборки проекта
*   **Docker & Docker Compose** — для контейнеризации приложения и окружения
*   **Springdoc OpenAPI (Swagger)** — для документации API

---

## Как запустить проект

### Требования
*   Java 17 (JDK)
*   Maven 3.8+
*   Docker и Docker Compose

### Запуск через Docker Compose

Этот способ поднимает все необходимые сервисы (приложение, PostgreSQL, Redis) в изолированных контейнерах.

1.  Убедитесь, что Docker запущен.
2.  В корне проекта выполните команду:
    ```bash
    docker-compose up --build
    ```
3.  Приложение будет доступно по адресу `http://localhost:8888`.
4.  Чтобы остановить и удалить контейнеры, нажмите `Ctrl+C` и выполните:
    ```bash
    docker-compose down
    ```

---

## Структура API

### Аутентификация

Все эндпоинты (кроме `/api/auth/register`) требуют **Basic Authentication**.

Пример тестовых пользователей можно создать через эндпоинт регистрации.

### Эндпоинты

**Базовый URL:** `http://localhost:8888`

#### Аутентификация

*   `POST /api/auth/register` - Регистрация нового пользователя.
    *   **Тело запроса:**
        ```json
        {
          "name": "John",
          "surname": "Doe",
          "email": "john.doe@example.com",
          "password": "password123"
        }
        ```

#### Задачи (Tasks)

*   `POST /api/tasks` - Создать новую задачу.
    *   **Тело запроса:**
        ```json
        {
          "taskName": "Моя новая задача",
          "description": "Описание моей новой задачи"
        }
        ```
*   `GET /api/tasks` - Получить список всех задач.
*   `GET /api/tasks/{id}` - Получить задачу по ID.
*   `PUT /api/tasks/{id}` - Обновить задачу по ID.
*   `DELETE /api/tasks/{id}` - Удалить (пометить как удаленную) задачу по ID.

---

## Документация API (Swagger)

После запуска приложения интерактивная документация API (Swagger UI) будет доступна по адресу:

[http://localhost:8888/swagger-ui/index.html](http://localhost:8888/swagger-ui/index.html)

Здесь вы можете изучить все эндпоинты и отправлять тестовые запросы прямо из браузера.